NOTE: Currently, the recording program’s interface and all supporting materials are limited to the Chinese version.

作者：赵炳亮 zhaobingliang@pku.edu.cn
日期：2025-11-21
*基于Deepseek、Gemini提供代码优化实现*

### 更新 2026-01-15
增加了配套的PRAAT脚本(annotation.praat)，用于生成长音频的标注。
注意：请现将录音时间戳数据的excel表格文件另存为“Unicode 文本(.txt)”，在脚本运行后输入txt文件地址、音频文件地址、和开始录音时音频文件标记时间（见下面使用方法）
如果音频文件过长，程序报错，请在音频文件处直接输入音频总时长（单位是秒）,将直接按时长创建textgrid文件。

### 更新 2026-01-05
增加了在刺激呈现中显示图片的功能（可选只显示文本、只显示图片或二者均显示），请使用recordingForProductionWithImage.html。
注意在stimuli.xlsx中增加一列名为“picture”的变量，用于储存每个刺激对应的图片的本地地址

# 前言

本程序用于语音产出实验时，控制刺激文本的呈现，可实现随机化、自动保存起止时间（以便后续切分音频）。本程序自身并不具备录音功能，建议配合录音软件（如Audition）一起使用。

# 使用方法

1. 准备好你的录音词表(.xlsx)，包含两列，表头分别是“key”、“text”。建议对每个条目设置唯一的编码key，以便后续处理，text对应需要呈现给被试的文本。如在录制中您需要重复录制某个条目，建议通过复制方式扩充列表，同时在key上体现不同的重复次数（比如A01、B01表示该文本两次出现，见stimuli.xlsx示例）。不建议在同一个条目内要求被试读2遍（这可能引入语调、协同发音，被试也难以控制两次间隔时长）
2. 如果你希望词表随机呈现，但每个被试的条目顺序相同，那么，请你在词表xlsx中自行完成一次随机化，而不要在本程序中设置随机（因为本程序中设置随机每次都会不同，无法保证不同被试录制时顺序相同）
3. 打开recordingForProduction.html，导入词表文件；此时可以设置随机排序，可多次设置。
4. 打开你的录音程序（如Audition），确保此时已经开始录制，在html中点击“开始录音”的同时，在录音程序中打标记，以对齐两个程序的时间。此步骤如遗忘，后期将难以通过html生成的起止时间准确切分各个条目。
5. 开始录音后，右侧文本呈现处会先呈现500ms的“+”注视点，然后呈现文本。在“进度”处会有绿色阴影高亮当前录制的条目。被试朗读完毕后，由实验员操作点击“下一个”（需要确保被试完全读完内容，最好能停顿一会儿实验员再操作点击“下一个”），此时，在“进度”处，录制完成的条目会呈现为绿色。如此循环。
6. 如需要重新录制某个已录制条目，在该条目进度块绿色状态下，单击可以转换为红色，即需要重新录制；若再次单击红色条目则取消标记，还原为绿色。红色的条目会在整个表格录制完成后，自动重新进行录制，重新录制的时间戳会在导出时覆盖之前旧的时间戳。
7. 完成录制后，可以通过“导出数据”将每个条目对应的起止时间点导出为xlsx文件。导出后请马上打开检查数据，无误后注意修改文件名（至少包含被试信息，否则会和其他文件混淆）
8. 开始新的录制、中断当前录制重新开始，都需要重新打开html，此前所有时间数据都不会保存。
9. 在录制过程中，可以随时点击“导出数据”，将导出当前已录制条目的起止时间。
10. 在左侧“文本呈现字体大小”处，可随时调整右侧文本字体大小（16-88px），但建议在开始录制前调整好，而不在过程中调整。
11. 导出数据中experimentStartTime是按协调世界时（UTC）记录的，加上8小时就是北京时间。
12. 一定要在正式开展实验前，自己完整过一遍实验流程，确保本程序正常运行、导出时间戳无误。
